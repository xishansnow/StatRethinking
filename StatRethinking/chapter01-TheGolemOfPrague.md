---
jupytext:
  formats: ipynb,md:myst
  text_representation:
    extension: .md
    format_name: myst
    format_version: 0.13
    jupytext_version: 1.10.3
kernelspec:
  display_name: Python 3 (ipykernel)
  language: python
  name: python3
---

# 第 1 章 统计工具与反思

在十六世纪，哈布斯堡家族控制了中欧、荷兰和西班牙的大部分地区，以及西班牙在美洲的殖民地。该家族可能是第一个真正的世界强国。太阳总是照耀着它的某些部分。它的统治者也是神圣罗马帝国皇帝，他的权力所在地是布拉格。十六世纪末的皇帝，鲁道夫二世，热爱知识生活。他投资于艺术、科学（包括占星术和炼金术）和数学，使布拉格成为世界学习和学术的中心。因此，在这种博学的氛围中出现了一个早期的机器人-- **布拉格泥人**。

泥人是犹太民间传说中的一种粘土机器人，由灰尘、火和水构成。通过在它眉心处刻上 `emet`（希伯来语中 "事实" 的意思），它就被赋予了生命。泥人被真理激活，但缺乏自由的思想，它总是完全按照别人的要求行事。泥人具有难以置信的能力，能够承担并完成比人更多的工作。然而，其顺从也带来了危险，因为粗心的指令或未预料到的事件会使泥人与其创造者反目。

在泥人的传说中，有一个版本是关于 “ `Rabbi Judah Loew ben Bezalel` 寻求一种方法来保护布拉格的犹太人” 的。正如十六世纪中欧的许多地方一样，布拉格的犹太人受到了迫害。`Rabbi Judah` 利用了犹太教中的一种神秘的 `Kabbalah` 技术，建造了一个泥人，用 "真理 "赋予它生命，并命令它保卫布拉格的犹太人。并非所有人都同意 `Rabbi Judah` 的行为，因为他们担心玩弄生命的力量会带来意想不到的后果。最终，`Rabbi Judah` 被迫销毁了这只泥人，因为其超凡的力量与蠢笨的头脑结合，最终导致了无辜死亡。`Rabbi Judah` 抹去了 `emet` 中的第一个字母，使其变为 `met` （希伯来语中 "死亡" 的意思），从此泥人退役了。

## 1.1 统计泥人

科学家们也制造泥人，只是这种泥人很少有物理形式，它们也几乎由 “粘土” 制成，作为计算机代码生活在硅中。**科学模型**就是科学家们的泥人，只不过这些泥人通过自身做出的预测以及他们挑战或激发的直觉，对世界产生了非常巨大的影响。与 “事实” 的联系激活了这些模型，但就像泥人或现代机器人一样，科学模型既不真实也不虚假，既不是先知也不是江湖骗子。它们只是为某种目的而设计的结构，尽职尽责地进行程序计算。

有时，科学模型底层不屈不挠的逻辑能够揭示一些了其设计者看不到的深层影响，这些影响甚至可能是无价的发现。但也可能会产生愚蠢和危险的行为。科学模型不是理想化的天使，而是强大但没有自身意识的泥人，根据自身的就近指令笨拙地前进。就像 `Rabbi Judah` 的泥人一样，科学泥人也被明智地看待，既敬畏又担心。我们必须使用它们，但这样做又总是会带来风险。

统计模型有很多种。每当有人部署一个简单的统计程序时，比如经典的 $t$ 检验，就是在部署一个泥人，它会乖乖地进行精确计算，每次都以几乎相同的方式执行，没有抱怨。几乎每个科学分支都依赖于统计泥人。在许多情况下，如果不使用模型，甚至无法度量感兴趣的现象。为了度量自然选择的强度、或者度量中微子的速度、或者度量亚马逊地区的物种数量，我们都必须使用模型。泥人是一个为我们做度量的假肢，它进行令人印象深刻的计算，寻找一些不显著的模式。

但泥人没有智慧，它无法辨别上下文何时不适用于其答案。泥人只知道自己的程序，照章办事，别的什么都不知道。因此，现在存在这么多不同的泥人，每一个都在特定环境中有用。从这个角度看，统计学既非数学也非科学，似乎是工程学的一个分支。和工程学一样，一套通用设计原则和约束产生了大量的专业应用程序。

这种应用的多样性有助于解释为什么一些入门的统计课程经常让初学者感到困惑和手足无措。因为与构建、改进和评估统计模型的单一方法不同，学生现在得到的是一个预先构建好的、被称为 “检验” 的泥人工具箱，里面的每个 “检验泥人” 都有一个特定目的。在此场景下，图 1.1 所示的决策树就比较常见了，通过回答一系列连续的问题，用户可以选择适合其研究上下文的 “正确” 统计程序。

不幸的是，虽然部分有经验的统计学家掌握了此类程序的统一性，但学生和研究人员很少能够做到。统计学的高级课程确实也会强调工程原理，但大多数科学家从未走到那么远。因此，用这种方式教授统计学就有点像反向工程学，从搭建桥梁开始，到基础物理结束。导致学生和许多科学家倾向于使用图 1.1 之类的图表，而对底层结构思考太少。他们可能对每个统计程序所包含的模型没有太多了解，也没有任何框架来帮助他们做出实际研究所需的、不可避免的妥协，但这都不是他们的错。

对于某些人来说，预制的泥人工具箱就是他们所需要的。如果他们处于经过良好检验的环境中，在适当任务中只使用几个不同的统计程序，就可以完成许多好的科学研究工作。这类似于管道工可以在不了解流体力学的情况下，完成许多有用的工作。但是当学者们开始进行创新研究，突破其专业界限时，严重的麻烦就开始了，而此时就像我们要将水管工提拔为液压工程师一样，会发现他存在很多知识缺陷。

为什么“检验” 不足以支撑研究工作？经典的入门级统计程序往往是不灵活和脆弱的。其中，不灵活指其适应特定研究环境的方式非常有限；脆弱指其在应用于新环境时会以不可预测的方式失败。这些都很重要，因为在大多数科学的边界上，几乎不清楚哪种统计程序是合适的。传统的 “泥人” 都没有在新研究环境中做过评估，因此很难选择，更难以了解其行为方式了。一个很好的例子是 `Fisher` 精确检验，它应用于极其狭窄的经验环境中，在细胞计数很少时经常使用。我个人在科学期刊上阅读了数百个 `Fisher` 精确检验的应用案例，但除了 `Fisher` 最初的用法外，从未见过它真正适当地被使用过。即便是普通线性回归这样的入门级统计程序，在很多方面非常灵活，而且能够编码大量有趣的假设，但有时也很脆弱。例如，如果预测变量存在重大测量误差，那么该程序可能会以惊人的方式失败。最糟糕地是，几乎总有比普通线性回归做得更好的可能性，这主要是因为一种称为过拟合的现象（第 7 章）。

我认为关键不在于统计工具是否是专门的（它们本当然是专门的），而是经典工具的多样性不足以处理许多常见的研究问题。每个活跃的科学领域都面临着度量和解释的独特困难，都在用一种特殊的方言、就其他领域科学家几乎不理解的特殊理论在进行对话。学科外的统计专家可以提供帮助，但会受限于缺乏对该学科的经验和理论问题的流畅性。

此外，没有任何统计工具可以自行地从证据推断原因。统计泥人不了解因果关系，它们只懂得交互。如果没有我们的指导和质疑，预制的泥人可能毫无用处，更糟糕的是，他们可能毁掉 “布拉格” 。

研究人员需要一些统一的泥人工程理论，一套用于设计、构建和完善专用统计程序的原理或原则。统计哲学的每个主要分支都拥有这样一个统一的理论。但该理论从未在介绍性课程中讲授，甚至在高级课程中也被遗忘。因此，对统计推断进行充分反思，将其视为一组策略而非预制工具对广大科学工作者是有好处的。

![image-20211203085037272](https://gitee.com/XiShanSnow/imagebed/raw/master/images/stats-20211203085107-8093.webp)

> **图 1.1** 。 一个用于选择适当统计程序的决策树或流程图（示例）。用户从顶部开始，回答一系列关于测量和意图的问题，最终选用的抵达统计程序的名称。许多这样的决策树是可能的。

## 1.2 统计反思

统计推断可能会出现很多错误，这也是初学者如此焦虑的原因之一。当我们的目标是从流程图中选择一个预先准备好的工具时，焦虑会随着人们对选择 “正确” 工具的担忧而增加。而统计学家则可以从责备科学家中获得乐趣，从而使心理斗争变得更严重。

但焦虑可以培养成智慧。这就是本书坚持使用每个“泥人”的螺母和螺栓的原因。如果你不了解泥人是如何处理信息的，那么你就无法解释泥人的输出。这需要比通常更详细地了解模型，并且需要以艰难的方式进行计算，至少在您足够明智地使用按钮解决方案之前是如此的。

还有概念上的障碍，学者如何定义统计对象和解释统计结果的障碍。在这些情况下，仅仅了解任何一个泥人是不够的。相反，我们需要一些统计认识论，了解统计模型如何与假设和研究的自然机制相关联。我们到底应该用这些计算机做什么？

我在学生和同事中遇到的最大障碍是：**他们默认统计推断的正确目标是检验零假设**。

> 通俗点理解，大部分学者为了证明自己设想的正确性，而花了大量精力去思考如何证伪零假设（零假设通常指自身假设的逆假设，按照某些科学哲学观点，人们通常无法通过归纳法证实正假设，但证伪伪逆假设却很容易），反而忘记了找到合适的模型才是根本目标。从而本末倒置。

这种想法来源于卡尔·波普尔的科学认识论，他认为科学是通过证伪假设来进步的，如果假设都是证实的，那么科学就会停滞不前了。卡尔·波普尔（1902-1994）可能是最有影响力的科学哲学家，至少在科学家中是如此。他确实有说服力地争辩说，科学可以通过改进 “原则上可证伪的假设” 而工作得更好。“寻找可能让我们的想法很尴尬的证据（意即证伪）” 是一个比较规范性的科学研究标准，也是大多数学者（无论他们是否自称为科学家）都认同的标准。所以，如果想成为一名优秀的统计科学家，也许统计程序中应该证伪假设。

但以上仅仅是一种民间波普尔主义，一种非正式的科学哲学，在科学家中很常见，但在科学哲学家中却并不常见。波普尔自己也认识到，科学不是用证伪标准来描述的。事实上，演绎式的证伪在几乎所有科学背景下都是不可能的。在本节中，我将回顾导致这种不可能的两个原因。

（1） **假设和模型并不等价**。假设和各种模型之间的关系很复杂。许多模型可能对应于同一个假设，许多假设也可能对应于一个模型。这使得严格证伪成为不可能。

（2） **度量问题**。即使我们认为数据证伪了一个模型，也会有一些人会对我们的方法和度量措施进行争论。他们可能不相信这些数据，而且有时他们可能是对的。

由于这两个原因，演绎式的证伪永远不会奏效。科学方法不能简化为统计程序，因此我们的统计方法不应该装。统计证据是科学这一混乱体中的一部分，它充满了斗争、自负和相互胁迫。如果你和我一样相信科学确实有效，那么 “通过伪造表明其不起作用” 这种作法不应该改变你的想法，但它可能会帮助你做得更好。它可能会让你看到统计泥人的许多合理有用的新功能。

### 1.2.1 假设和模型不等价

当我们试图证伪一个假设时，我们必须使用某种模型。即使不是非常明确的统计尝试，也总是有一个默认的关于度量和证据的模型来运行假设。

根据某位学者的说法，所有模型都是错误的，那么证伪一个模型还有什么意义呢？

使用模型的需求带来一个后果是：不再可能仅仅因为拒绝了一个从假设中推导出的模型，就推断出整个假设都是错误的。

让我们在人口生物学的一个例子中探讨这个结果（图 1.2）。从 1960 年代开始，进化生物学家开始对基因频率的大部分进化变化不是由自然选择而是由突变和漂移引起的提议感兴趣。没有人真正怀疑自然选择对功能设计负有责任。这是一场关于基因序列的辩论。于是开始了几十年对分子进化的“中性”模型的学术争论。7 这种争论与木村元雄 (1924-1994) 的关系最为密切，他可能是中性模型的最坚定拥护者。但许多其他种群遗传学家也参与了进来。随着时间的推移，社区生态学 8 和人类学 9 等相关学科已经经历（或正在经历）他们自己版本的中立性辩论。

在中性进化辩论的背景下，让我们使用图 1.2 中的示意图来探索动机假设和不同模型之间的联系。在左边，有两个刻板的、非正式的假设：要么进化是“中性的”（H0），要么自然选择在某种程度上很重要（H1）。这些假设有模糊的界限，因为它们始于口头推测，而不是精确的模型。有数百种可能的详细过程可以被描述为“中性”，这取决于对种群结构、位点数量、每个位点的等位基因数量、突变率和重组的选择。





### 1.2.2 不要忽视观测的影响


### 1.2.3 证伪是两厢情愿的事

科学界确实逐步认识到某些假设是错误的。例如：宇宙地心模型不在科学课程中教授了，除非是为了教授它们是如何被证伪的。而且科学中的很多证据往往（ 但不总是 ）与这种证伪有关。

但事实上，证伪是两厢情愿的事，并非合乎逻辑的事。

在测量误差问题和自然现象的连续性等影响下，科学界一直在争论科学证据的真正含义，而且并未达成共识。有些争论甚至可能是混乱的。事实上，一些教科书修改或歪曲了历史，从而使得证伪显得合乎逻辑。这种历史修正主义可能会伤害到每个人。它可能会伤害科学家，使其工作无法达到之前的高度；它可能会是科学称为一个容易被攻击的目标，仅仅是因为推广了一种容易受到攻击的科学认识论模型；它可能会上海大众，通过夸大科学知识的确定性。

## 1.3 泥人工程学的工具箱

因此，试图模仿证伪不是统计方法中的普遍有用的途径，我们该怎么办？我们要建模。

模型不仅仅是检验程序（注意：所有的统计检验都是模型），它们还可以用于设计、预测和论证。科学研究工作往往会受益于对模型的生成和操作能力，这是因为科学问题比 “检验” 更广泛，而且介绍性统计课程中教授的预制泥人并不适合许多研究环境。很多时候，你甚至不知道要使用哪种统计模型，除非自己另外有一个生成模型。

如果你想减少破坏布拉格的机会，那么需要一些泥人工程的专业知识。毫无疑问，你最终可能会毁了布拉格，但如果你是一名优秀的泥人工程师，至少你会注意到破坏。而如果您对泥人的工作原理有更多了解，您还很有可能找出问题所在。或许你的下一个泥人就不会那么糟糕了。但反之，如果没有工程学培训，你总会受制于人。

我们希望将模型用于几个不同的目的：设计试验、从数据中提取信息、预测。但在本书中，将专注于几个帮助实现上述目的的工具。这些工具是： 

 (1) 贝叶斯数据分析；
 (2) 模型比较；
 (3) 多级模型； 
 (4) 图因果模型。

这些工具彼此之间有很深的关联，因此一起讲授它们非常有意义。与往常一样，对这些工具的理解只能通过动手来实现 --- “除非你做到了，否则你无法理解泥人工程” --- 所以本书主要关注代码以及如何做。不过在本章其余部分，我还是会先介绍以下这些工具。

### 1.3.1.贝叶斯数据分析

假设你有一些数据，你应该如何使用它来了解世界？这个问题没有唯一正确的答案。许多方法，无论是正式的还是启发式的，都是有效的。但最有效和最通用的答案之一是使用贝叶斯数据分析。贝叶斯数据分析以模型的形式提出问题，并使用逻辑以概率分布的形式产生答案。

简而言之，贝叶斯数据分析只不过是根据我们的假设，计算数据可能发生方式的数量，以更多方式发生的事情更合理。概率论是相关的，因为概率只是用于计数的演算工具。这使我们能够使用概率论作为表示合理性的一般性方法，无论是用于表示世界上的可数事件，还是诸如参数等理论构造。而剩下的工作似乎都是具备逻辑的了。**一旦我们定义了统计模型，贝叶斯数据分析就迫使我们以一种纯粹的逻辑方式来处理数据以产生推断**。

第 2 章深入解释了这一点。本章采用另一种方法来解释可能会有所帮助。

贝叶斯概率是一种非常通用的概率方法，它包括作为特殊情况的另一种重要方法，即**频率主义方法**。频率主义方法要求所有概率都通过 “与大样本中事件频率的联系” 来定义。这导致频率主义方法中的不确定性，必须以假想的数据重采样为前提：即如果多次重复观测，我们最终会收集到一个具有某种模式的值列表。这意味着只有观测值可以有概率分布，而参数和模型不能有。这些观测值的分布称为抽样分布。这种重采样永远无法完成，而且通常甚至没有任何意义（例如：对安第斯山脉鸣禽的多样化进行重采样是荒谬的 ）。正如 20 世纪最重要的常客统计学家之一罗纳德·费舍尔爵士 ( `Sir Ronald Fisher`) 所说：

```
统计显著性检验中关心的总体并非客观现实，完全是统计学家的想象力 [...]
```

但在许多情况下，比如受控温室实验，它是描述不确定性的有用工具。无论上下文如何，它只是模型的一部分，是对重采样后数据外观的假设。这与使用概率来描述所有类型的不确定性（无论是经验性的还是认识论的）的贝叶斯策略一样荒诞不经。 

但是这些对概率的不同态度确实会强制进行不同的权衡。考虑这个简单的例子，其中贝叶斯概率和频率概率之间的差异很重要。 1610 年，伽利略将原始望远镜转向夜空，成为第一个看到土星环的人类。好吧，他可能看到了一个斑点，上面附有一些较小的斑点（图 1.3）。由于望远镜是原始的，它不能很好地聚焦图像。土星总是显得模糊。这是一个统计问题。行星的形状存在不确定性，但请注意，所有不确定性都不是重复测量变化的结果。我们可以通过望远镜观察一千次，它总是会给出相同的模糊图像（对于地球和土星的任何给定位置）。所以任何测量的采样分布都是恒定的，因为测量是确定性的——它没有任何“随机”的东西。频率论统计推断在这里入门有很多麻烦。相比之下，贝叶斯推理照常进行，因为只要我们不使用频率识别概率，仍然可以使用概率对确定性“噪声”进行建模。因此，图像重建和处理领域由贝叶斯算法主导。

在更常规的统计程序中，如线性回归，概率概念的这种差异影响较小。然而，重要的是要意识到，即使贝叶斯程序和频率论程序给出完全相同的答案，我们的贝叶斯傀儡也不能用想象的重复采样来证明他们的推论是正确的。更一般地说，贝叶斯魔像将“随机性”视为信息的属性，而不是世界的属性。现实世界中没有任何东西——除了对量子物理学的有争议的解释——实际上是随机的。据推测，如果我们有更多的信息，我们可以准确地预测一切。我们只是用随机性来描述我们面对不完整知识时的不确定性。从我们的 golem 的角度来看，抛硬币是“随机的”，但实际上是 golem 是随机的，而不是硬币。

## 1.4 总结

第一章主张对流行的统计学和科学哲学进行反思。我们应该学会去构建和分析自然现象的多种非零模型，而不是对各种黑盒工具做零假设检验。为了支持该目标，本章介绍了贝叶斯推断、模型比较、分层模型和图因果模型。本书的其余部分分为四个部分：

（ 1 ）第 2 章和第 3 章是基础。他们介绍了贝叶斯推理和执行贝叶斯计算的基本工具。他们的动作非常缓慢，并强调对概率论的纯逻辑解释。 

（ 2 ）接下来的第 4 到 8 章，将多元线性回归作为贝叶斯工具。该工具支持因果推断，但前提是我们需要分析单独的因果模型以确定需要包含哪些变量。出于这个原因，你将学习由因果图支持的基本因果推断。这些章节强调绘制分析结果，而不是试图解释单个参数的估计值。模型复杂性问题（即过拟合）也很突出。因此，第 7 章还将介绍信息论和预测模型比较。

（ 3 ）本书第 9 章至第 12 章，介绍了几种类型的广义线性模型。第 9 章介绍了用于拟合后面章节中模型的马尔可夫链蒙特卡罗方法。第 10 章介绍了最大熵方法，作为帮助我们设计和解释模型的明确程序。然后第 11 章和第 12 章详细介绍了广义线性模型。 

（ 4 ）最后一部分，第 13 章到第 16 章，讨论了分层模型，以及解决测量误差、缺失数据和空间协变的专门模型。这种内容和主题相当先进，但它是以与早期材料相同的机械方式进行的。第 16 章与本书其他部分不同，它采用的模型不是广义的线性类型，而是直接表达为统计模型的科学模型。

（ 5 ）第 17 章又回归到了第一章中探讨的一些问题。

在每一章末尾，都有从易到难的练习题。这些问题帮助你检验自己的理解力。其中较难的问题是对书本的扩展，介绍了一些新例子和困难。有些题相当难。不要担心，如果你不时地被卡住，那么在小组中工作是摆脱困境的好方法，就像在实际研究中一样。